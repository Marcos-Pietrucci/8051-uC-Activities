Simulação 9                                                                                                             PAGE 1
                         1     ;*      Marcos Vinícius Firmino Pietrucci      *
                         2     ;*      10770072                               *
                         3     ;***********************************************
                         4
                         5     ; ****************** PROGRAMA ******************
                         6
                         7     ;Lê caracteres do teclado matricial e exibe em display LDC 2x16
                         8
                         9             ;Pinos de controle de dados e de informações do LCD
  00B4                  10             RS      EQU     P3.4
  00B3                  11             RW      EQU     P3.3
  00B2                  12             ENAB    EQU     P3.2
  00A0                  13             DAT     EQU     P2
                        14
                        15     ;************************************************
                        16
                        17                     ORG     0
0000 116B               18     SETUP:          ACALL   INIT_LCD
0002 1185               19                     ACALL   CLR_LCD
0004 7400               20                     MOV     A, #00  ; O simlador não posiciona o cursos na posição 0
0006 1191               21                     ACALL   POS_LCD
                        22
                        23     ;***** Loop principal ***********
0008 7590FF             24     INIC:           MOV     P1, #0FFH
000B 787F               25                     MOV     R0, #7FH
000D 1127               26     LOOP:           ACALL   VARRE
000F E590               27                     MOV     A, P1
0011 44FF               28                     ORL     A, #0FFH
0013 B4FF02             29                     CJNE    A, #0FFH, TECLA
0016 80F5               30                     SJMP    LOOP
0018 E590               31     TECLA:          MOV     A, P1
001A 1133               32                     ACALL   ASCII_TECLA
001C 1160               33                     ACALL   WRITE_TEXT
                        34
001E E590               35     ESPERA:         MOV     A, P1           ;Trava o programa aqui até que a chave seja aberta
0020 44F0               36                     ORL     A, #0F0H
0022 B4FFF9             37                     CJNE    A, #0FFH, ESPERA
0025 80E1               38                     SJMP    INIC
                        39
                        40     ;**************************************************
0027 E8                 41     VARRE:          MOV     A, R0
0028 F590               42                     MOV     P1, A
002A 03                 43                     RR      A
002B 30E302             44                     JNB     ACC.3, FIM
002E F8                 45                     MOV     R0,A
002F 22                 46                     RET
0030 787F               47     FIM:            MOV     R0, #7FH
0032 22                 48                     RET
                        49     ;**************************************************
                        50     ;Subrotina que codifica a tecla do teclado matricial para ASCII
0033 900050             51     ASCII_TECLA:    MOV     DPTR,#TECLADO
0036 F540               52                     MOV     40H, A
0038 E4                 53                     CLR     A
0039 FF                 54     CONT1:          MOV     R7, A
003A 93                 55                     MOVC    A, @A+DPTR
003B B54003             56                     CJNE    A, 40H, OUTRO
003E EF                 57                     MOV     A, R7
003F 8004               58                     SJMP    CONV_ASCII
0041 EF                 59     OUTRO:          MOV     A,R7
0042 04                 60                     INC     A
0043 80F4               61                     SJMP    CONT1
0045 B40A00             62     CONV_ASCII:     CJNE    A, #0AH, TEST
0048 4002               63     TEST:           JC      NUMERO
004A 2407               64                     ADD     A, #7
004C C3                 65     NUMERO:         CLR     C
004D 2430               66                     ADD     A, #30H
004F 22                 67                     RET
                        68
0050 D7EEDEBEED         69     TECLADO:        DB      0D7H, 0EEH, 0DEH, 0BEH, 0EDH, 0DDH, 0BDH, 0EBH, 0DBH, 0BBH, 7EH, 7DH, 7BH, 77
     DDBDEBDBBB
     7E7D7B77E7
     B7
                        70
                        71     ;**************************************************
                        72     ;Subrotina que mostra um caractere ASCII no LCD
0060 C2B3               73     WRITE_TEXT:     CLR     RW      ;Modo de escrtia
0062 D2B4               74                     SETB    RS      ;Dado a ser enviado
0064 D2B2               75                     SETB    ENAB
0066 F5A0               76                     MOV     DAT, A
0068 C2B2               77                     CLR     ENAB    ;Pulso no enable
006A 22                 78                     RET
                        79     ;*************************************************
                        80     ;Subrotina que liga e configura o LCD
006B C2B3               81     INIT_LCD:       CLR     RW
006D C2B4               82                     CLR     RS
006F D2B2               83                     SETB    ENAB
0071 75A038             84                     MOV     DAT, #38H       ;2x16 e matriz 5x7
0074 C2B2               85                     CLR     ENAB
0076 D2B2               86                     SETB    ENAB
0078 75A00E             87                     MOV     DAT, #0EH       ;Display on/off
007B C2B2               88                     CLR     ENAB
007D D2B2               89                     SETB    ENAB
007F 75A006             90                     MOV     DAT, #06H       ;Modo de entrada
0082 C2B2               91                     CLR     ENAB
0084 22                 92                     RET
                        93
                        94     ;**************************************************
0085 C2B3               95     CLR_LCD:        CLR     RW
0087 C2B4               96                     CLR     RS
0089 D2B2               97                     SETB    ENAB
008B 75A001             98                     MOV     DAT, #01H
008E C2B2               99                     CLR     ENAB
0090 22                100                     RET
                       101     ;**************************************************
0091 C2B3              102     POS_LCD:        CLR     RW
0093 C2B4              103                     CLR     RS
0095 D2B2              104                     SETB    ENAB
0097 2480              105                     ADD     A, #80H
0099 F5A0              106                     MOV     DAT, A
009B C2B2              107                     CLR     ENAB
009D 22                108                     RET
                       109
                       110             END
ASSEMBLY COMPLETE, NO ERRORS FOUND, NO WARNINGS


SYMBOL TABLE:
??MCU_8051_IDE . . . . . . . . . . .  N  NUMB  8051H  NOT USED
??VERSION. . . . . . . . . . . . . .  N  NUMB  0149H  NOT USED
AC . . . . . . . . . . . . . . . . .  B  ADDR  00D6H  NOT USED
ACC. . . . . . . . . . . . . . . . .  D  ADDR  00E0H
ACSR . . . . . . . . . . . . . . . .  D  ADDR  0097H  NOT USED
ADCF . . . . . . . . . . . . . . . .  D  ADDR  00F6H  NOT USED
ADCLK. . . . . . . . . . . . . . . .  D  ADDR  00F2H  NOT USED
ADCON. . . . . . . . . . . . . . . .  D  ADDR  00F3H  NOT USED
ADDH . . . . . . . . . . . . . . . .  D  ADDR  00F5H  NOT USED
ADDL . . . . . . . . . . . . . . . .  D  ADDR  00F4H  NOT USED
ASCII_TECLA. . . . . . . . . . . . .  C  ADDR  0033H
AUXR . . . . . . . . . . . . . . . .  D  ADDR  008EH  NOT USED
AUXR1. . . . . . . . . . . . . . . .  D  ADDR  00A2H  NOT USED
B. . . . . . . . . . . . . . . . . .  D  ADDR  00F0H  NOT USED
BDRCON . . . . . . . . . . . . . . .  D  ADDR  009BH  NOT USED
BDRCON_1 . . . . . . . . . . . . . .  D  ADDR  009CH  NOT USED
BRL. . . . . . . . . . . . . . . . .  D  ADDR  009AH  NOT USED
CCAP0H . . . . . . . . . . . . . . .  D  ADDR  00FAH  NOT USED
CCAP0L . . . . . . . . . . . . . . .  D  ADDR  00EAH  NOT USED
CCAP1H . . . . . . . . . . . . . . .  D  ADDR  00FBH  NOT USED
CCAP1L . . . . . . . . . . . . . . .  D  ADDR  00EBH  NOT USED
CCAP2H . . . . . . . . . . . . . . .  D  ADDR  00FCH  NOT USED
CCAP3H . . . . . . . . . . . . . . .  D  ADDR  00FDH  NOT USED
CCAP4H . . . . . . . . . . . . . . .  D  ADDR  00FEH  NOT USED
CCAPL2H. . . . . . . . . . . . . . .  D  ADDR  00FCH  NOT USED
CCAPL2L. . . . . . . . . . . . . . .  D  ADDR  00ECH  NOT USED
CCAPL3H. . . . . . . . . . . . . . .  D  ADDR  00FDH  NOT USED
CCAPL3L. . . . . . . . . . . . . . .  D  ADDR  00EDH  NOT USED
CCAPL4H. . . . . . . . . . . . . . .  D  ADDR  00FEH  NOT USED
CCAPL4L. . . . . . . . . . . . . . .  D  ADDR  00EEH  NOT USED
CCAPM0 . . . . . . . . . . . . . . .  D  ADDR  00DAH  NOT USED
CCAPM1 . . . . . . . . . . . . . . .  D  ADDR  00DBH  NOT USED
CCAPM2 . . . . . . . . . . . . . . .  D  ADDR  00DCH  NOT USED
CCAPM3 . . . . . . . . . . . . . . .  D  ADDR  00DDH  NOT USED
CCAPM4 . . . . . . . . . . . . . . .  D  ADDR  00DEH  NOT USED
CCF0 . . . . . . . . . . . . . . . .  B  ADDR  00D8H  NOT USED
CCF1 . . . . . . . . . . . . . . . .  B  ADDR  00D9H  NOT USED
CCF2 . . . . . . . . . . . . . . . .  B  ADDR  00DAH  NOT USED
CCF3 . . . . . . . . . . . . . . . .  B  ADDR  00DBH  NOT USED
CCF4 . . . . . . . . . . . . . . . .  B  ADDR  00DCH  NOT USED
CCON . . . . . . . . . . . . . . . .  D  ADDR  00D8H  NOT USED
CFINT. . . . . . . . . . . . . . . .  C  ADDR  0033H  NOT USED
CH . . . . . . . . . . . . . . . . .  D  ADDR  00F9H  NOT USED
CKCON. . . . . . . . . . . . . . . .  D  ADDR  008FH  NOT USED
CKCON0 . . . . . . . . . . . . . . .  D  ADDR  008FH  NOT USED
CKRL . . . . . . . . . . . . . . . .  D  ADDR  0097H  NOT USED
CKSEL. . . . . . . . . . . . . . . .  D  ADDR  0085H  NOT USED
CL . . . . . . . . . . . . . . . . .  D  ADDR  00E9H  NOT USED
CLKREG . . . . . . . . . . . . . . .  D  ADDR  008FH  NOT USED
CLR_LCD. . . . . . . . . . . . . . .  C  ADDR  0085H
CMOD . . . . . . . . . . . . . . . .  D  ADDR  00D9H  NOT USED
CONT1. . . . . . . . . . . . . . . .  C  ADDR  0039H
CONV_ASCII . . . . . . . . . . . . .  C  ADDR  0045H
CPRL2. . . . . . . . . . . . . . . .  B  ADDR  00C8H  NOT USED
CR . . . . . . . . . . . . . . . . .  B  ADDR  00DEH  NOT USED
CT2. . . . . . . . . . . . . . . . .  B  ADDR  00C9H  NOT USED
CY . . . . . . . . . . . . . . . . .  B  ADDR  00D7H  NOT USED
DAT. . . . . . . . . . . . . . . . .  N  NUMB  00A0H
DP0H . . . . . . . . . . . . . . . .  D  ADDR  0083H  NOT USED
DP0L . . . . . . . . . . . . . . . .  D  ADDR  0082H  NOT USED
DP1H . . . . . . . . . . . . . . . .  D  ADDR  0085H  NOT USED
DP1L . . . . . . . . . . . . . . . .  D  ADDR  0084H  NOT USED
DPH. . . . . . . . . . . . . . . . .  D  ADDR  0083H  NOT USED
DPL. . . . . . . . . . . . . . . . .  D  ADDR  0082H  NOT USED
EA . . . . . . . . . . . . . . . . .  B  ADDR  00AFH  NOT USED
EC . . . . . . . . . . . . . . . . .  B  ADDR  00AEH  NOT USED
EECON. . . . . . . . . . . . . . . .  D  ADDR  0096H  NOT USED
ENAB . . . . . . . . . . . . . . . .  N  NUMB  00B2H
ES . . . . . . . . . . . . . . . . .  B  ADDR  00ACH  NOT USED
ESPERA . . . . . . . . . . . . . . .  C  ADDR  001EH
ET0. . . . . . . . . . . . . . . . .  B  ADDR  00A9H  NOT USED
ET1. . . . . . . . . . . . . . . . .  B  ADDR  00ABH  NOT USED
ET2. . . . . . . . . . . . . . . . .  B  ADDR  00ADH  NOT USED
EX0. . . . . . . . . . . . . . . . .  B  ADDR  00A8H  NOT USED
EX1. . . . . . . . . . . . . . . . .  B  ADDR  00AAH  NOT USED
EXEN2. . . . . . . . . . . . . . . .  B  ADDR  00CBH  NOT USED
EXF2 . . . . . . . . . . . . . . . .  B  ADDR  00CEH  NOT USED
EXTI0. . . . . . . . . . . . . . . .  C  ADDR  0003H  NOT USED
EXTI1. . . . . . . . . . . . . . . .  C  ADDR  0013H  NOT USED
F0 . . . . . . . . . . . . . . . . .  B  ADDR  00D5H  NOT USED
FE . . . . . . . . . . . . . . . . .  B  ADDR  009FH  NOT USED
FIM. . . . . . . . . . . . . . . . .  C  ADDR  0030H
IE . . . . . . . . . . . . . . . . .  D  ADDR  00A8H  NOT USED
IE0. . . . . . . . . . . . . . . . .  B  ADDR  0089H  NOT USED
IE1. . . . . . . . . . . . . . . . .  B  ADDR  008BH  NOT USED
INIC . . . . . . . . . . . . . . . .  C  ADDR  0008H
INIT_LCD . . . . . . . . . . . . . .  C  ADDR  006BH
INT0 . . . . . . . . . . . . . . . .  B  ADDR  00B2H  NOT USED
INT1 . . . . . . . . . . . . . . . .  B  ADDR  00B3H  NOT USED
IP . . . . . . . . . . . . . . . . .  D  ADDR  00B8H  NOT USED
IPH. . . . . . . . . . . . . . . . .  D  ADDR  00B7H  NOT USED
IPH0 . . . . . . . . . . . . . . . .  D  ADDR  00B7H  NOT USED
IPH1 . . . . . . . . . . . . . . . .  D  ADDR  00B3H  NOT USED
IPL0 . . . . . . . . . . . . . . . .  D  ADDR  00B8H  NOT USED
IPL1 . . . . . . . . . . . . . . . .  D  ADDR  00B2H  NOT USED
IT0. . . . . . . . . . . . . . . . .  B  ADDR  0088H  NOT USED
IT1. . . . . . . . . . . . . . . . .  B  ADDR  008AH  NOT USED
KBE. . . . . . . . . . . . . . . . .  D  ADDR  009DH  NOT USED
KBF. . . . . . . . . . . . . . . . .  D  ADDR  009EH  NOT USED
KBLS . . . . . . . . . . . . . . . .  D  ADDR  009CH  NOT USED
LOOP . . . . . . . . . . . . . . . .  C  ADDR  000DH
NUMERO . . . . . . . . . . . . . . .  C  ADDR  004CH
OSCCON . . . . . . . . . . . . . . .  D  ADDR  0086H  NOT USED
OUTRO. . . . . . . . . . . . . . . .  C  ADDR  0041H
OV . . . . . . . . . . . . . . . . .  B  ADDR  00D2H  NOT USED
P. . . . . . . . . . . . . . . . . .  B  ADDR  00D0H  NOT USED
P0 . . . . . . . . . . . . . . . . .  D  ADDR  0080H  NOT USED
P1 . . . . . . . . . . . . . . . . .  D  ADDR  0090H
P1M1 . . . . . . . . . . . . . . . .  D  ADDR  00D4H  NOT USED
P1M2 . . . . . . . . . . . . . . . .  D  ADDR  00E2H  NOT USED
P2 . . . . . . . . . . . . . . . . .  D  ADDR  00A0H  NOT USED
P3 . . . . . . . . . . . . . . . . .  D  ADDR  00B0H  NOT USED
P3M1 . . . . . . . . . . . . . . . .  D  ADDR  00D5H  NOT USED
P3M2 . . . . . . . . . . . . . . . .  D  ADDR  00E3H  NOT USED
P4 . . . . . . . . . . . . . . . . .  D  ADDR  00C0H  NOT USED
P4M1 . . . . . . . . . . . . . . . .  D  ADDR  00D6H  NOT USED
P4M2 . . . . . . . . . . . . . . . .  D  ADDR  00E4H  NOT USED
P5 . . . . . . . . . . . . . . . . .  D  ADDR  00E8H  NOT USED
PC . . . . . . . . . . . . . . . . .  B  ADDR  00BEH  NOT USED
PCON . . . . . . . . . . . . . . . .  D  ADDR  0087H  NOT USED
POS_LCD. . . . . . . . . . . . . . .  C  ADDR  0091H
PPCL . . . . . . . . . . . . . . . .  B  ADDR  00BEH  NOT USED
PS . . . . . . . . . . . . . . . . .  B  ADDR  00BCH  NOT USED
PSL. . . . . . . . . . . . . . . . .  B  ADDR  00BCH  NOT USED
PSW. . . . . . . . . . . . . . . . .  D  ADDR  00D0H  NOT USED
PT0. . . . . . . . . . . . . . . . .  B  ADDR  00B9H  NOT USED
PT0L . . . . . . . . . . . . . . . .  B  ADDR  00B9H  NOT USED
PT1. . . . . . . . . . . . . . . . .  B  ADDR  00BBH  NOT USED
PT1L . . . . . . . . . . . . . . . .  B  ADDR  00BBH  NOT USED
PT2. . . . . . . . . . . . . . . . .  B  ADDR  00BDH  NOT USED
PT2L . . . . . . . . . . . . . . . .  B  ADDR  00BDH  NOT USED
PX0. . . . . . . . . . . . . . . . .  B  ADDR  00B8H  NOT USED
PX0L . . . . . . . . . . . . . . . .  B  ADDR  00B8H  NOT USED
PX1. . . . . . . . . . . . . . . . .  B  ADDR  00BAH  NOT USED
PX1L . . . . . . . . . . . . . . . .  B  ADDR  00BAH  NOT USED
RB8. . . . . . . . . . . . . . . . .  B  ADDR  009AH  NOT USED
RCAP2H . . . . . . . . . . . . . . .  D  ADDR  00CBH  NOT USED
RCAP2L . . . . . . . . . . . . . . .  D  ADDR  00CAH  NOT USED
RCLK . . . . . . . . . . . . . . . .  B  ADDR  00CDH  NOT USED
RD . . . . . . . . . . . . . . . . .  B  ADDR  00B7H  NOT USED
REN. . . . . . . . . . . . . . . . .  B  ADDR  009CH  NOT USED
RESET. . . . . . . . . . . . . . . .  C  ADDR  0000H  NOT USED
RI . . . . . . . . . . . . . . . . .  B  ADDR  0098H  NOT USED
RS . . . . . . . . . . . . . . . . .  N  NUMB  00B4H
RS0. . . . . . . . . . . . . . . . .  B  ADDR  00D3H  NOT USED
RS1. . . . . . . . . . . . . . . . .  B  ADDR  00D4H  NOT USED
RW . . . . . . . . . . . . . . . . .  N  NUMB  00B3H
RXD. . . . . . . . . . . . . . . . .  B  ADDR  00B0H  NOT USED
SADDR. . . . . . . . . . . . . . . .  D  ADDR  00A9H  NOT USED
SADDR_0. . . . . . . . . . . . . . .  D  ADDR  00A9H  NOT USED
SADDR_1. . . . . . . . . . . . . . .  D  ADDR  00AAH  NOT USED
SADEN. . . . . . . . . . . . . . . .  D  ADDR  00B9H  NOT USED
SADEN_0. . . . . . . . . . . . . . .  D  ADDR  00B9H  NOT USED
SADEN_1. . . . . . . . . . . . . . .  D  ADDR  00BAH  NOT USED
SBUF . . . . . . . . . . . . . . . .  D  ADDR  0099H  NOT USED
SCON . . . . . . . . . . . . . . . .  D  ADDR  0098H  NOT USED
SETUP. . . . . . . . . . . . . . . .  C  ADDR  0000H  NOT USED
SINT . . . . . . . . . . . . . . . .  C  ADDR  0023H  NOT USED
SM0. . . . . . . . . . . . . . . . .  B  ADDR  009FH  NOT USED
SM1. . . . . . . . . . . . . . . . .  B  ADDR  009EH  NOT USED
SM2. . . . . . . . . . . . . . . . .  B  ADDR  009DH  NOT USED
SP . . . . . . . . . . . . . . . . .  D  ADDR  0081H  NOT USED
SPCON. . . . . . . . . . . . . . . .  D  ADDR  00C3H  NOT USED
SPCR . . . . . . . . . . . . . . . .  D  ADDR  00D5H  NOT USED
SPDAT. . . . . . . . . . . . . . . .  D  ADDR  00C5H  NOT USED
SPDR . . . . . . . . . . . . . . . .  D  ADDR  0086H  NOT USED
SPSR . . . . . . . . . . . . . . . .  D  ADDR  00AAH  NOT USED
SPSTA. . . . . . . . . . . . . . . .  D  ADDR  00C4H  NOT USED
T0 . . . . . . . . . . . . . . . . .  B  ADDR  00B4H  NOT USED
T1 . . . . . . . . . . . . . . . . .  B  ADDR  00B5H  NOT USED
T2CON. . . . . . . . . . . . . . . .  D  ADDR  00C8H  NOT USED
T2MOD. . . . . . . . . . . . . . . .  D  ADDR  00C9H  NOT USED
TB8. . . . . . . . . . . . . . . . .  B  ADDR  009BH  NOT USED
TCLK . . . . . . . . . . . . . . . .  B  ADDR  00CCH  NOT USED
TCON . . . . . . . . . . . . . . . .  D  ADDR  0088H  NOT USED
TECLA. . . . . . . . . . . . . . . .  C  ADDR  0018H
TECLADO. . . . . . . . . . . . . . .  C  ADDR  0050H
TEST . . . . . . . . . . . . . . . .  C  ADDR  0048H
TF0. . . . . . . . . . . . . . . . .  B  ADDR  008DH  NOT USED
TF1. . . . . . . . . . . . . . . . .  B  ADDR  008FH  NOT USED
TF2. . . . . . . . . . . . . . . . .  B  ADDR  00CFH  NOT USED
TH0. . . . . . . . . . . . . . . . .  D  ADDR  008CH  NOT USED
TH1. . . . . . . . . . . . . . . . .  D  ADDR  008DH  NOT USED
TH2. . . . . . . . . . . . . . . . .  D  ADDR  00CDH  NOT USED
TI . . . . . . . . . . . . . . . . .  B  ADDR  0099H  NOT USED
TIMER0 . . . . . . . . . . . . . . .  C  ADDR  000BH  NOT USED
TIMER1 . . . . . . . . . . . . . . .  C  ADDR  001BH  NOT USED
TIMER2 . . . . . . . . . . . . . . .  C  ADDR  002BH  NOT USED
TL0. . . . . . . . . . . . . . . . .  D  ADDR  008AH  NOT USED
TL1. . . . . . . . . . . . . . . . .  D  ADDR  008BH  NOT USED
TL2. . . . . . . . . . . . . . . . .  D  ADDR  00CCH  NOT USED
TMOD . . . . . . . . . . . . . . . .  D  ADDR  0089H  NOT USED
TR0. . . . . . . . . . . . . . . . .  B  ADDR  008CH  NOT USED
TR1. . . . . . . . . . . . . . . . .  B  ADDR  008EH  NOT USED
TR2. . . . . . . . . . . . . . . . .  B  ADDR  00CAH  NOT USED
TXD. . . . . . . . . . . . . . . . .  B  ADDR  00B1H  NOT USED
VARRE. . . . . . . . . . . . . . . .  C  ADDR  0027H
WDTCON . . . . . . . . . . . . . . .  D  ADDR  00A7H  NOT USED
WDTPRG . . . . . . . . . . . . . . .  D  ADDR  00A7H  NOT USED
WDTRST . . . . . . . . . . . . . . .  D  ADDR  00A6H  NOT USED
WR . . . . . . . . . . . . . . . . .  B  ADDR  00B6H  NOT USED
WRITE_TEXT . . . . . . . . . . . . .  C  ADDR  0060H